"use strict";/* (c) Robby Kraft, MIT License */require("core-js/modules/es6.array.sort"),require("core-js/modules/es6.regexp.search"),require("core-js/modules/es6.regexp.split"),require("core-js/modules/es6.regexp.match"),require("core-js/modules/es6.regexp.replace"),require("core-js/modules/es6.regexp.to-string"),require("core-js/modules/es7.symbol.async-iterator"),require("core-js/modules/es6.symbol"),require("core-js/modules/web.dom.iterable"),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.foldify=t()}(void 0,function(){'use strict';var G=Math.tan,B=Math.atan2,U=Math.max,W=Math.PI,J=Math.sin,$=Math.cos,ee=Math.sqrt,te=Math.pow,ne=Math.abs;/* (c) Robby Kraft, MIT License
   * makes use of these libraries:
   * - SVG Path Properties by Roger Veciana i Rovira
   * - vkBeautify by Vadim Kiryukhin
   */function t(e){return n(e)||i(e)||r()}function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){var t=[];return e.replace(ce,function(e,n,i){var r=n.toLowerCase();for(i=l(i),"m"===r&&2<i.length&&(t.push([n].concat(i.splice(0,2))),r="l",n="m"===n?"l":"L");0<=i.length;){if(i.length===oe[r])return i.unshift(n),t.push(i);if(i.length<oe[r])throw new Error("malformed path data");t.push([n].concat(i.splice(0,oe[r])))}}),t}function l(e){var t=e.match(ge);return t?t.map(Number):[]}function o(e,t,n,i,r,a,l,o){return new c(e,t,n,i,r,a,l,o)}function c(t,n,i,r,a,l,o,c){this.a={x:t,y:n},this.b={x:i,y:r},this.c={x:a,y:l},this.d={x:o,y:c},null!==o&&o!==void 0&&null!==c&&c!==void 0?(this.getArcLength=e,this.getPoint=f,this.getDerivative=d):(this.getArcLength=h,this.getPoint=s,this.getDerivative=g),this.init()}function g(e,n,i){return{x:2*(1-i)*(e[1]-e[0])+2*i*(e[2]-e[1]),y:2*(1-i)*(n[1]-n[0])+2*i*(n[2]-n[1])}}function d(e,n,i){var t=s([3*(e[1]-e[0]),3*(e[2]-e[1]),3*(e[3]-e[2])],[3*(n[1]-n[0]),3*(n[2]-n[1]),3*(n[3]-n[2])],i);return t}function p(e,n,i,r,a){for(var l=1,o=e/n,c=(e-i(r,a,o))/n,g=0;.001<l;){var d=i(r,a,o+c),p=i(r,a,o-c),s=ne(e-d)/n,f=ne(e-p)/n;if(s<l?(l=s,o+=c):f<l?(l=f,o-=c):c/=2,g++,500<g)break}return o}function s(e,n,i){var t=(1-i)*(1-i)*e[0]+2*(1-i)*i*e[1]+i*i*e[2],r=(1-i)*(1-i)*n[0]+2*(1-i)*i*n[1]+i*i*n[2];return{x:t,y:r}}function f(e,n,i){var t=(1-i)*(1-i)*(1-i)*e[0]+3*(1-i)*(1-i)*i*e[1]+3*(1-i)*i*i*e[2]+i*i*i*e[3],r=(1-i)*(1-i)*(1-i)*n[0]+3*(1-i)*(1-i)*i*n[1]+3*(1-i)*i*i*n[2]+i*i*i*n[3];return{x:t,y:r}}function h(e,n,i){i===void 0&&(i=1);var r=e[0]-2*e[1]+e[2],a=n[0]-2*n[1]+n[2],l=2*e[1]-2*e[0],o=2*n[1]-2*n[0],c=4*(r*r+a*a);if(0===c)return i*ee(te(e[2]-e[0],2)+te(n[2]-n[0],2));var g=4*(r*l+a*o)/(2*c),d=i+g,p=(l*l+o*o)/c-g*g,s=0<d*d+p?ee(d*d+p):0,f=0<g*g+p?ee(g*g+p):0,h=0===g+ee(g*g+p)?0:p*Math.log(ne((d+s)/(g+f)));return ee(c)/2*(d*s-g*f+h)}function y(e,t){return se[e][t]}function m(e,i,t){var r,a,l,o=t.length-1;if(0==o)return 0;if(0===e){for(a=0,l=0;l<=o;l++)a+=y(o,l)*te(1-i,o-l)*te(i,l)*t[l];return a}for(r=Array(o),l=0;l<o;l++)r[l]=o*(t[l+1]-t[l]);return m(e-1,i,r)}function u(e,n,i){var t=m(1,i,e),r=m(1,i,n);return ee(t*t+r*r)}function e(e,n,r){var a,l,o,c;r===void 0&&(r=1);for(a=r/2,l=0,o=0;o<20;o++)c=a*de[20][o]+a,l+=pe[20][o]*u(e,n,c);return a*l}function _(e,t,n,i,r,a,l,o,c){return new v(e,t,n,i,r,a,l,o,c)}function v(e,n,i,r,a,l,o,c,g){this.x0=e,this.y0=n,this.rx=i,this.ry=r,this.xAxisRotate=a,this.LargeArcFlag=l,this.SweepFlag=o,this.x1=c,this.y1=g;var t=b(300,function(d){return k({x:e,y:n},i,r,a,l,o,{x:c,y:g},d)});this.length=t.arcLength}function k(e,n,i,r,a,l,o,c){n=ne(n),i=ne(i),r=P(r,360);var t=L(r);if(e.x===o.x&&e.y===o.y)return e;if(0===n||0===i)return this.pointOnLine(e,o,c);var g=(e.x-o.x)/2,d=(e.y-o.y)/2,p={x:$(t)*g+J(t)*d,y:-J(t)*g+$(t)*d},s=te(p.x,2)/te(n,2)+te(p.y,2)/te(i,2);1<s&&(n=ee(s)*n,i=ee(s)*i);var f=te(n,2)*te(i,2)-te(n,2)*te(p.y,2)-te(i,2)*te(p.x,2),h=te(n,2)*te(p.y,2)+te(i,2)*te(p.x,2),y=f/h;y=0>y?0:y;var m=(a===l?-1:1)*ee(y),u={x:m*(n*p.y/i),y:m*(-(i*p.x)/n)},_={x:$(t)*u.x-J(t)*u.y+(e.x+o.x)/2,y:J(t)*u.x+$(t)*u.y+(e.y+o.y)/2},x={x:(p.x-u.x)/n,y:(p.y-u.y)/i},v=E({x:1,y:0},x),k={x:(-p.x-u.x)/n,y:(-p.y-u.y)/i},b=E(x,k);!l&&0<b?b-=2*W:l&&0>b&&(b+=2*W),b%=2*W;var A=v+b*c,w=n*$(A),S=i*J(A),j={x:$(t)*w-J(t)*S+_.x,y:J(t)*w+$(t)*S+_.y};return j.ellipticalArcStartAngle=v,j.ellipticalArcEndAngle=v+b,j.ellipticalArcAngle=A,j.ellipticalArcCenter=_,j.resultantRx=n,j.resultantRy=i,j}function b(e,n){e=e?e:500;for(var r,a,l=0,o=[],c=[],g=n(0),d=0;d<e;d++)a=w(d*(1/e),0,1),r=n(a),l+=A(g,r),c.push([g,r]),o.push({t:a,arcLength:l}),g=r;return r=n(1),c.push([g,r]),l+=A(g,r),o.push({t:1,arcLength:l}),{arcLength:l,arcLengthMap:o,approximationLines:c}}function P(e,t){return(e%t+t)%t}function L(e){return e*(W/180)}function A(e,t){return ee(te(t.x-e.x,2)+te(t.y-e.y,2))}function w(e,t,n){return Math.min(U(e,t),n)}function E(e,t){var i=e.x*t.x+e.y*t.y,r=ee((te(e.x,2)+te(e.y,2))*(te(t.x,2)+te(t.y,2))),n=0>e.x*t.y-e.y*t.x?-1:1,a=n*Math.acos(i/r);return a}function S(e,t,n,i){return new j(e,t,n,i)}function j(e,t,n,i){this.x0=e,this.x1=t,this.y0=n,this.y1=i}function T(e){function t(e){if(!e)return null;for(var c,g,d=a(e),p=[0,0],s=[0,0],f=0;f<d.length;f++)"M"===d[f][0]?(p=[d[f][1],d[f][2]],g=[p[0],p[1]],l.push(null)):"m"===d[f][0]?(p=[d[f][1]+p[0],d[f][2]+p[1]],g=[p[0],p[1]],l.push(null)):"L"===d[f][0]?(n+=ee(te(p[0]-d[f][1],2)+te(p[1]-d[f][2],2)),l.push(new S(p[0],d[f][1],p[1],d[f][2])),p=[d[f][1],d[f][2]]):"l"===d[f][0]?(n+=ee(te(d[f][1],2)+te(d[f][2],2)),l.push(new S(p[0],d[f][1]+p[0],p[1],d[f][2]+p[1])),p=[d[f][1]+p[0],d[f][2]+p[1]]):"H"===d[f][0]?(n+=ne(p[0]-d[f][1]),l.push(new S(p[0],d[f][1],p[1],p[1])),p[0]=d[f][1]):"h"===d[f][0]?(n+=ne(d[f][1]),l.push(new S(p[0],p[0]+d[f][1],p[1],p[1])),p[0]=d[f][1]+p[0]):"V"===d[f][0]?(n+=ne(p[1]-d[f][1]),l.push(new S(p[0],p[0],p[1],d[f][1])),p[1]=d[f][1]):"v"===d[f][0]?(n+=ne(d[f][1]),l.push(new S(p[0],p[0],p[1],p[1]+d[f][1])),p[1]=d[f][1]+p[1]):"z"===d[f][0]||"Z"===d[f][0]?(n+=ee(te(g[0]-p[0],2)+te(g[1]-p[1],2)),l.push(new S(p[0],g[0],p[1],g[1])),p=[g[0],g[1]]):"C"===d[f][0]?(c=new o(p[0],p[1],d[f][1],d[f][2],d[f][3],d[f][4],d[f][5],d[f][6]),n+=c.getTotalLength(),p=[d[f][5],d[f][6]],l.push(c)):"c"===d[f][0]?(c=new o(p[0],p[1],p[0]+d[f][1],p[1]+d[f][2],p[0]+d[f][3],p[1]+d[f][4],p[0]+d[f][5],p[1]+d[f][6]),0<c.getTotalLength()?(n+=c.getTotalLength(),l.push(c),p=[d[f][5]+p[0],d[f][6]+p[1]]):l.push(new S(p[0],p[0],p[1],p[1]))):"S"===d[f][0]?(c=0<f&&-1<["C","c","S","s"].indexOf(d[f-1][0])?new o(p[0],p[1],2*p[0]-d[f-1][d[f-1].length-4],2*p[1]-d[f-1][d[f-1].length-3],d[f][1],d[f][2],d[f][3],d[f][4]):new o(p[0],p[1],p[0],p[1],d[f][1],d[f][2],d[f][3],d[f][4]),n+=c.getTotalLength(),p=[d[f][3],d[f][4]],l.push(c)):"s"===d[f][0]?(c=0<f&&-1<["C","c","S","s"].indexOf(d[f-1][0])?new o(p[0],p[1],p[0]+c.d.x-c.c.x,p[1]+c.d.y-c.c.y,p[0]+d[f][1],p[1]+d[f][2],p[0]+d[f][3],p[1]+d[f][4]):new o(p[0],p[1],p[0],p[1],p[0]+d[f][1],p[1]+d[f][2],p[0]+d[f][3],p[1]+d[f][4]),n+=c.getTotalLength(),p=[d[f][3]+p[0],d[f][4]+p[1]],l.push(c)):"Q"===d[f][0]?(c=p[0]==d[f][1]&&p[1]==d[f][2]?new S(d[f][1],d[f][3],d[f][2],d[f][4]):new o(p[0],p[1],d[f][1],d[f][2],d[f][3],d[f][4]),n+=c.getTotalLength(),l.push(c),p=[d[f][3],d[f][4]],s=[d[f][1],d[f][2]]):"q"===d[f][0]?(c=0==d[f][1]&&0==d[f][2]?new S(p[0]+d[f][1],p[0]+d[f][3],p[1]+d[f][2],p[1]+d[f][4]):new o(p[0],p[1],p[0]+d[f][1],p[1]+d[f][2],p[0]+d[f][3],p[1]+d[f][4]),n+=c.getTotalLength(),s=[p[0]+d[f][1],p[1]+d[f][2]],p=[d[f][3]+p[0],d[f][4]+p[1]],l.push(c)):"T"===d[f][0]?(c=0<f&&-1<["Q","q","T","t"].indexOf(d[f-1][0])?new o(p[0],p[1],2*p[0]-s[0],2*p[1]-s[1],d[f][1],d[f][2]):new S(p[0],d[f][1],p[1],d[f][2]),l.push(c),n+=c.getTotalLength(),s=[2*p[0]-s[0],2*p[1]-s[1]],p=[d[f][1],d[f][2]]):"t"===d[f][0]?(c=0<f&&-1<["Q","q","T","t"].indexOf(d[f-1][0])?new o(p[0],p[1],2*p[0]-s[0],2*p[1]-s[1],p[0]+d[f][1],p[1]+d[f][2]):new S(p[0],p[0]+d[f][1],p[1],p[1]+d[f][2]),n+=c.getTotalLength(),s=[2*p[0]-s[0],2*p[1]-s[1]],p=[d[f][1]+p[0],d[f][2]+p[0]],l.push(c)):"A"===d[f][0]?(c=new _(p[0],p[1],d[f][1],d[f][2],d[f][3],d[f][4],d[f][5],d[f][6],d[f][7]),n+=c.getTotalLength(),p=[d[f][6],d[f][7]],l.push(c)):"a"===d[f][0]&&(c=new _(p[0],p[1],d[f][1],d[f][2],d[f][3],d[f][4],d[f][5],p[0]+d[f][6],p[1]+d[f][7]),n+=c.getTotalLength(),p=[p[0]+d[f][6],p[1]+d[f][7]],l.push(c)),r.push(n);return t}var n=0,r=[],l=[];t.getTotalLength=function(){return n},t.getPointAtLength=function(e){var t=c(e);return l[t.i].getPointAtLength(t.fraction)},t.getTangentAtLength=function(e){var t=c(e);return l[t.i].getTangentAtLength(t.fraction)},t.getPropertiesAtLength=function(e){var t=c(e);return l[t.i].getPropertiesAtLength(t.fraction)},t.getParts=function(){for(var e=[],t=0;t<l.length;t++)if(null!=l[t]){var n={};n.start=l[t].getPointAtLength(0),n.end=l[t].getPointAtLength(r[t]-r[t-1]),n.length=r[t]-r[t-1],function(e){n.getPointAtLength=function(t){return e.getPointAtLength(t)},n.getTangentAtLength=function(t){return e.getTangentAtLength(t)},n.getPropertiesAtLength=function(t){return e.getPropertiesAtLength(t)}}(l[t]),e.push(n)}return e};var c=function(e){0>e?e=0:e>n&&(e=n);for(var t=r.length-1;r[t]>=e&&0<r[t];)t--;return t++,{fraction:e-r[t-1],i:t}};return t(e)}function z(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),i=n.length,r=!1,a=0,l="",o=null!=t&&"string"==typeof t?t:"\t",c=["\n"],g=0;100>g;g+=1)c.push(c[g]+o);for(var d=0;d<i;d+=1)-1<n[d].search(/<!/)?(l+=c[a]+n[d],r=!0,(-1<n[d].search(/-->/)||-1<n[d].search(/\]>/)||-1<n[d].search(/!DOCTYPE/))&&(r=!1)):-1<n[d].search(/-->/)||-1<n[d].search(/\]>/)?(l+=n[d],r=!1):/^<\w/.exec(n[d-1])&&/^<\/\w/.exec(n[d])&&/^<[\w:\-\.\,]+/.exec(n[d-1])==/^<\/[\w:\-\.\,]+/.exec(n[d])[0].replace("/","")?(l+=n[d],r||(a-=1)):-1<n[d].search(/<\w/)&&-1===n[d].search(/<\//)&&-1===n[d].search(/\/>/)?l=r?l+=n[d]:l+=c[a++]+n[d]:-1<n[d].search(/<\w/)&&-1<n[d].search(/<\//)?l=r?l+=n[d]:l+=c[a]+n[d]:-1<n[d].search(/<\//)?l=r?l+=n[d]:l+=c[--a]+n[d]:-1<n[d].search(/\/>/)?l=r?l+=n[d]:l+=c[a]+n[d]:l+=-1<n[d].search(/<\?/)?c[a]+n[d]:-1<n[d].search(/xmlns\:/)||-1<n[d].search(/xmlns\=/)?c[a]+n[d]:n[d];return"\n"===l[0]?l.slice(1):l}function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function O(e,t){return D(e)||F(e,t)||I()}function M(e){return q(e)||R(e)||X()}function q(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function D(e){if(Array.isArray(e))return e}function R(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function F(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var l,o=e[Symbol.iterator]();!(i=(l=o.next()).done)&&(n.push(l.value),!(t&&n.length===t));i=!0);}catch(e){r=!0,a=e}finally{try{i||null==o["return"]||o["return"]()}finally{if(r)throw a}}return n}function X(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function I(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function V(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return ut(t)}function C(){var e=Array.from(arguments),t=e.filter(function(e){return!isNaN(e)}),n=e.filter(function(e){return e.constructor===Array});if(0==e.length)return{vector:[],point:[]};if(!isNaN(e[0])&&4<=t.length)return{point:[e[0],e[1]],vector:[e[2],e[3]]};if(0<n.length){if(1===n.length)return C.apply(void 0,M(n[0]));if(2===n.length)return{point:[n[0][0],n[0][1]],vector:[n[1][0],n[1][1]]};if(4===n.length)return{point:[n[0],n[1]],vector:[n[2],n[3]]}}if(e[0].constructor===Object){var i=[],r=[];return null==e[0].vector?null!=e[0].direction&&(i=mt(e[0].direction)):i=mt(e[0].vector),null==e[0].point?null!=e[0].origin&&(r=mt(e[0].origin)):r=mt(e[0].point),{point:r,vector:i}}return{point:[],vector:[]}}function Z(){return C.apply(void 0,arguments)}function Y(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){if(1===t.length&&void 0!==t[0])return Y.apply(void 0,M(t[0]));var i=Array.from(t),r=i.filter(function(e){return!isNaN(e)}),a=i.filter(function(e){return"object"===N(e)}).filter(function(e){return e.constructor===Array});return 4<=r.length?[[r[0],r[1]],[r[2],r[3]]]:2<=a.length&&!isNaN(a[0][0])?a:1!==a.length||isNaN(a[0][0][0])?void 0:a[0]}}function K(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?void 0:1===t.length&&void 0!==t[0]?K.apply(void 0,M(t[0])):Array.from(t)}function Q(e,t){var n=null==t?{}:t,i=function(e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:vt;return this.compare_function(e,t)&&!0},r=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:vt;return this.compare_function(e,n)&&t>=-n},a=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:vt;return this.compare_function(e,n)&&t>=-n&&t<=1+n};return Object.defineProperty(n,"isParallel",{value:function(e,t){if(null==e.vector)throw"line isParallel(): please ensure object contains a vector";var n=this.vector.length<e.vector.length,i=n?this.vector:e.vector,r=n?e.vector:this.vector;return jt(i,r,t)}}),Object.defineProperty(n,"isDegenerate",{value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:vt;return St(this.vector,e)}}),Object.defineProperty(n,"nearestPoint",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=mt(t);return On(Pn(this.point,this.vector,i,this.clip_function))}}),Object.defineProperty(n,"reflection",{value:function(){return Mn.makeReflection(this.vector,this.point)}}),Object.defineProperty(n,"intersect",{value:function(e){var t=this;return Wt(this.point,this.vector,e.point,e.vector,function(n,i){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:vt;return t.compare_function(n,r)&&e.compare_function(i,r)})}}),Object.defineProperty(n,"intersectLine",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=C(t);return Wt(this.point,this.vector,r.point,r.vector,i.bind(this))}}),Object.defineProperty(n,"intersectRay",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Z(t);return Wt(this.point,this.vector,i.point,i.vector,r.bind(this))}}),Object.defineProperty(n,"intersectEdge",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=V(t),r=[i[1][0]-i[0][0],i[1][1]-i[0][1]];return Wt(this.point,this.vector,i[0],r,a.bind(this))}}),Object.freeze(n)}function H(e){var t={},n=e,i=function(){return _n(this.points)},r=function(){return this.points.map(function(e,t,n){return[n[(t+n.length-1)%n.length],n[t],n[(t+1)%n.length]]}).map(function(e){return Fn(e[1],e[2],e[0])})};return Object.defineProperty(t,"area",{value:i}),Object.defineProperty(t,"centroid",{value:function(){return xn(this.points)}}),Object.defineProperty(t,"midpoint",{value:function(){return Je(this.points)}}),Object.defineProperty(t,"enclosingRectangle",{value:function(){return vn(this.points)}}),Object.defineProperty(t,"contains",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return zt(mt(t),this.points)}}),Object.defineProperty(t,"nearest",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,a=mt(t),l=this.sides.map(function(e){return e.nearestPoint(a)}),o=1/0;return l.map(function(e){return et(a,e)}).forEach(function(e,t){e<o&&(o=e,r=t)}),{point:l[r],edge:this.sides[r]}}}),Object.defineProperty(t,"clipEdge",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=V(n),a=dn(this.points,r[0],r[1]);return void 0===a?void 0:Rn(a)}}),Object.defineProperty(t,"clipLine",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=C(n),a=cn(this.points,r.point,r.vector);return void 0===a?void 0:Rn(a)}}),Object.defineProperty(t,"clipRay",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=C(n),a=gn(this.points,r.point,r.vector);return void 0===a?void 0:Rn(a)}}),Object.defineProperty(t,"split",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=C(t);return Ln(this.points,r.point,r.vector).map(function(e){return n(e)})}}),Object.defineProperty(t,"scale",{value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:xn(this.points),i=this.points.map(function(e){return[0,1].map(function(n,r){return e[r]-t[r]})}).map(function(n){return n.map(function(r,a){return t[a]+n[a]*e})});return n(i)}}),Object.defineProperty(t,"rotate",{value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:xn(this.points),i=this.points.map(function(n){var i=[n[0]-t[0],n[1]-t[1]],r=ee(te(i[0],2)+te(i[1],2)),l=B(i[1],i[0]);return[t[0]+$(l+e)*r,t[1]+J(l+e)*r]});return n(i)}}),Object.defineProperty(t,"translate",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=mt(t),a=this.points.map(function(e){return e.map(function(e,t){return e+r[t]})});return n(a)}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=xt(t),a=this.points.map(function(e){return On(rt(e,r))});return n(a)}}),Object.defineProperty(t,"edges",{get:function(){return this.sides}}),Object.defineProperty(t,"sectors",{get:function(){return r()}}),Object.defineProperty(t,"signedArea",{value:i}),Object.freeze(t)}const ie="undefined"!=typeof window&&"undefined"!=typeof window.document,re="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,ae="object"==typeof self&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,le={};if(re){const{DOMParser:e,XMLSerializer:t}=require("xmldom");le.DOMParser=e,le.XMLSerializer=t,le.document=new e().parseFromString("<!DOCTYPE html><title>a</title>","text/html")}else ie&&(le.DOMParser=window.DOMParser,le.XMLSerializer=window.XMLSerializer,le.document=window.document);var oe={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},ce=/([astvzqmhlc])([^astvzqmhlc]*)/ig,ge=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;c.prototype={constructor:c,init:function(){this.length=this.getArcLength([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y])},getTotalLength:function(){return this.length},getPointAtLength:function(e){var n=p(e,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]);return this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],n)},getTangentAtLength:function(e){var n,i=p(e,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),t=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],i),r=ee(t.x*t.x+t.y*t.y);return n=0<r?{x:t.x/r,y:t.y/r}:{x:0,y:0},n},getPropertiesAtLength:function(e){var n,i=p(e,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),t=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],i),r=ee(t.x*t.x+t.y*t.y);n=0<r?{x:t.x/r,y:t.y/r}:{x:0,y:0};var a=this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],i);return{x:a.x,y:a.y,tangentX:n.x,tangentY:n.y}}};var de=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],pe=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],se=[[1],[1,1],[1,2,1],[1,3,3,1]];v.prototype={constructor:v,init:function(){},getTotalLength:function(){return this.length},getPointAtLength:function(e){0>e?e=0:e>this.length&&(e=this.length);var t=k({x:this.x0,y:this.y0},this.rx,this.ry,this.xAxisRotate,this.LargeArcFlag,this.SweepFlag,{x:this.x1,y:this.y1},e/this.length);return{x:t.x,y:t.y}},getTangentAtLength:function(e){0>e?e=0:e>this.length&&(e=this.length);var t=k({x:this.x0,y:this.y0},this.rx,this.ry,this.xAxisRotate,this.LargeArcFlag,this.SweepFlag,{x:this.x1,y:this.y1},e/this.length);return{x:t.x,y:t.y}},getPropertiesAtLength:function(e){var t=this.getTangentAtLength(e),n=this.getPointAtLength(e);return{x:n.x,y:n.y,tangentX:t.x,tangentY:t.y}}},j.prototype.getTotalLength=function(){return ee(te(this.x0-this.x1,2)+te(this.y0-this.y1,2))},j.prototype.getPointAtLength=function(e){var t=e/ee(te(this.x0-this.x1,2)+te(this.y0-this.y1,2)),n=(this.x1-this.x0)*t,i=(this.y1-this.y0)*t;return{x:this.x0+n,y:this.y0+i}},j.prototype.getTangentAtLength=function(){var e=ee((this.x1-this.x0)*(this.x1-this.x0)+(this.y1-this.y0)*(this.y1-this.y0));return{x:(this.x1-this.x0)/e,y:(this.y1-this.y0)/e}},j.prototype.getPropertiesAtLength=function(e){var t=this.getPointAtLength(e),n=this.getTangentAtLength();return{x:t.x,y:t.y,tangentX:n.x,tangentY:n.y}};var fe=128,he={value:0},ye=function(e){return e.split(" ").filter(function(e){return""!==e}).map(function(e){return e.split(",").map(function(e){return parseFloat(e)})})},me=function(e,t){var n=t.map(function(t){for(var n=0;n<e.attributes.length;n+=1)if(e.attributes[n].nodeName===t)return n});return n.map(function(t){return t===void 0?he:e.attributes[t]}).map(function(e){return e.value===void 0?e.baseVal.value:e.value})},ue=function(e){for(var t="",n=0;n<e.attributes.length;n+=1)if("points"===e.attributes[n].nodeName){t=e.attributes[n].value;break}return ye(t).map(function(e,t,n){return[n[t][0],n[t][1],n[(t+1)%n.length][0],n[(t+1)%n.length][1]]})},_e={line:function(e){return[me(e,["x1","y1","x2","y2"])]},rect:function(e){var t=me(e,["x","y","width","height"]),n=parseFloat(t[0]),i=parseFloat(t[1]),r=parseFloat(t[2]),a=parseFloat(t[3]);return[[n,i,n+r,i],[n+r,i,n+r,i+a],[n+r,i+a,n,i+a],[n,i+a,n,i]]},circle:function(e){var t=me(e,["cx","cy","r"]),n=parseFloat(t[0]),a=parseFloat(t[1]),l=parseFloat(t[2]);return Array.from(Array(64)).map(function(e,t){return[n+l*$(2*(t/64*W)),a+l*J(2*(t/64*W))]}).map(function(e,t,n){return[n[t][0],n[t][1],n[(t+1)%n.length][0],n[(t+1)%n.length][1]]})},ellipse:function(e){var t=me(e,["cx","cy","rx","ry"]),n=parseFloat(t[0]),r=parseFloat(t[1]),a=parseFloat(t[2]),l=parseFloat(t[3]);return Array.from(Array(64)).map(function(e,t){return[n+a*$(2*(t/64*W)),r+l*J(2*(t/64*W))]}).map(function(e,t,n){return[n[t][0],n[t][1],n[(t+1)%n.length][0],n[(t+1)%n.length][1]]})},polygon:ue,polyline:function(e){var t=ue(e);return t.pop(),t},path:function(e){var t=e.getAttribute("d"),n=T(t),i=n.getTotalLength(),r="Z"===t[t.length-1]||"z"===t[t.length-1],a=r?i/fe:i/(fe-1),l=Array.from(Array(fe)).map(function(e,t){return n.getPointAtLength(t*a)}).map(function(e){return[e.x,e.y]}),o=l.map(function(e,t,n){return[n[t][0],n[t][1],n[(t+1)%n.length][0],n[(t+1)%n.length][1]]});return r||o.pop(),o}},xe={};if(function(){return"undefined"==typeof window&&"undefined"!=typeof process}()){var ve=require("xmldom"),ke=ve.DOMParser,be=ve.XMLSerializer;xe.DOMParser=ke,xe.XMLSerializer=be,xe.document=new ke().parseFromString("<!DOCTYPE html><title> </title>","text/html")}else(function(){return"undefined"!=typeof window})()&&(xe.DOMParser=window.DOMParser,xe.XMLSerializer=window.XMLSerializer,xe.document=window.document);var Pe=function(e){var t=e.match(/(\w+\((\-?\d+\.?\d*e?\-?\d*,?\s*)+\))+/g),n=t.map(function(e){return e.match(/[\w\.\-]+/g)});return n.map(function(e){return{transform:e.shift(),parameters:e.map(function(e){return parseFloat(e)})}})},Le=function(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5],e[2]*t[0]+e[3]*t[2]+t[4],e[2]*t[1]+e[3]*t[3]+t[5]]},Ae=function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},we=function(e){switch(e.length){case 1:return[1,0,0,1,e[0],0];case 2:return[1,0,0,1,e[0],e[1]];default:console.warn("improper translate, ".concat(e));}},Ee=function(e){var t=$(e[0]/180*W),n=J(e[0]/180*W);switch(e.length){case 1:return[t,n,-n,t,0,0];case 3:return[t,n,-n,t,-e[1]*t+e[2]*n+e[1],-e[1]*n-e[2]*t+e[2]];default:console.warn("improper rotate, ".concat(e));}},Se=function(e){switch(e.length){case 1:return[e[0],0,0,e[0],0,0];case 2:return[e[0],0,0,e[1],0,0];default:console.warn("improper scale, ".concat(e));}},je=function(e){return[1,0,G(e[0]/180*W),1,0,0]},Te=function(e){return[1,G(e[0]/180*W),0,1,0,0]},ze=function(e,t){switch(e){case"translate":return we(t);case"rotate":return Ee(t);case"scale":return Se(t);case"skewX":return je(t);case"skewY":return Te(t);case"matrix":return t;default:console.warn("unknown transform type ".concat(e));}},Ne=function(e){return Pe(e).map(function(e){return ze(e.transform,e.parameters)}).filter(function(e){return e!==void 0}).reduce(function(e,t){return Ae(e,t)},[1,0,0,1,0,0])},Oe=function(e){if("function"!=typeof e.getAttribute)return[1,0,0,1,0,0];var t=e.getAttribute("transform");return null!=t&&""!==t?Ne(t):[1,0,0,1,0,0]},Me=function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[1,0,0,1,0,0],i=Ae(n,Oe(t));if(t.matrix=i,"g"===t.tagName||"svg"===t.tagName){if(null==t.childNodes)return;Array.from(t.childNodes).forEach(function(t){return e(t,i)})}},qe=Object.keys(_e),De="http://www.w3.org/2000/svg",Re={string:!0,svg:!1},Fe=["version","xmlns","contentScriptType","contentStyleType","baseProfile","class","externalResourcesRequired","x","y","width","height","viewBox","preserveAspectRatio","zoomAndPan","style"],Xe={line:["x1","y1","x2","y2"],rect:["x","y","width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],polygon:["points"],polyline:["points"],path:["d"]},Ie=function(e){return"string"==typeof e||e instanceof String?new xe.DOMParser().parseFromString(e,"text/xml").documentElement:e},Ve=function e(t){return"g"===t.tagName||"svg"===t.tagName?null==t.childNodes?[]:Array.from(t.childNodes).map(function(t){return e(t)}).reduce(function(e,t){return e.concat(t)},[]):[t]},Ce=function(e){return Array.from(e.attributes).filter(function(t){return-1===Xe[e.tagName].indexOf(t.name)})},Ze=function(e){var t={};return e.forEach(function(e){t[e.nodeName]=e.value}),t},Ye=function(e,n){var i=Ie(e);Me(i);var r=Ve(i),a=r.filter(function(t){return-1!==qe.indexOf(t.tagName)}).map(function(n){return _e[n.tagName](n).map(function(e){return Le(e,n.matrix)}).map(function(e){return[].concat(t(e),[Ce(n)])})}).reduce(function(e,t){return e.concat(t)},[]);a.filter(function(e){return e[4]!==void 0}).forEach(function(e){var t=e[4].filter(function(e){return"transform"!==e.nodeName});e[4]=Ze(t)});var l=Object.assign(Object.assign({},Re),n);if(l.svg){var o=xe.document.createElementNS(De,"svg");Fe.map(function(e){return{attribute:e,value:i.getAttribute(e)}}).filter(function(e){return null!=e.value&&""!==e.value}).forEach(function(e){return o.setAttribute(e.attribute,e.value)}),null===o.getAttribute("xmlns")&&o.setAttribute("xmlns",De);var c=r.filter(function(t){return"style"===t.tagName||"defs"===t.tagName});if(0<c.length&&c.map(function(e){return e.cloneNode(!0)}).forEach(function(e){return o.appendChild(e)}),a.forEach(function(e){var t=xe.document.createElementNS(De,"line");t.setAttributeNS(null,"x1",e[0]),t.setAttributeNS(null,"y1",e[1]),t.setAttributeNS(null,"x2",e[2]),t.setAttributeNS(null,"y2",e[3]),null!=e[4]&&Object.keys(e[4]).forEach(function(n){return t.setAttribute(n,e[4][n])}),o.appendChild(t)}),!1===l.string)return o;var g=new xe.XMLSerializer().serializeToString(o),d=z(g);return d}return a},Ke={black:"#000000",silver:"#c0c0c0",gray:"#808080",white:"#ffffff",maroon:"#800000",red:"#ff0000",purple:"#800080",fuchsia:"#ff00ff",green:"#008000",lime:"#00ff00",olive:"#808000",yellow:"#ffff00",navy:"#000080",blue:"#0000ff",teal:"#008080",aqua:"#00ffff",orange:"#ffa500",aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",blanchedalmond:"#ffebcd",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",oldlace:"#fdf5e6",olivedrab:"#6b8e23",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",whitesmoke:"#f5f5f5",yellowgreen:"#9acd32"};const Qe=Object.keys(Ke),He=function(e){let t=0,n=0,i=0,l=255;return 4===e.length?(t="0x".concat(e[1]).concat(e[1]),n="0x".concat(e[2]).concat(e[2]),i="0x".concat(e[3]).concat(e[3])):7===e.length?(t="0x".concat(e[1]).concat(e[2]),n="0x".concat(e[3]).concat(e[4]),i="0x".concat(e[5]).concat(e[6])):5===e.length?(t="0x".concat(e[1]).concat(e[1]),n="0x".concat(e[2]).concat(e[2]),i="0x".concat(e[3]).concat(e[3]),l="0x".concat(e[4]).concat(e[4])):9===e.length&&(t="0x".concat(e[1]).concat(e[2]),n="0x".concat(e[3]).concat(e[4]),i="0x".concat(e[5]).concat(e[6]),l="0x".concat(e[7]).concat(e[8])),[+(t/255),+(n/255),+(i/255),+(l/255)]},Ge=function(e){// cannot discern between mark and boundary
// boundary has to be decided by planar analysis
let t=[0,0,0,1];"#"===e[0]?t=He(e):-1!==Qe.indexOf(e)&&(t=He(Ke[e]));//
const n=.05;// black
return t[0]<n&&t[1]<n&&t[2]<n?"F":t[0]>t[1]&&t[0]-t[2]>n?"V":t[2]>t[1]&&t[2]-t[0]>n?"M":"F"};/* Math (c) Robby Kraft, MIT License */var Be=function(e){var t=e.map(function(e){return e*e}).reduce(function(e,t){return e+t},0);return ee(t)},Ue=function(e){var t=Be(e);return e.map(function(e){return e/t})},We=function(e,t){return e.map(function(n,r){return e[r]*t[r]}).reduce(function(e,t){return e+t},0)},Je=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=0<t.length?t[0].length:0,r=Array(i).fill(0);return t.forEach(function(e){return r.forEach(function(t,n){r[n]+=e[n]||0})}),r.map(function(e){return e/t.length})},$e=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[0]*t[2]-e[2]*t[0],e[0]*t[1]-e[1]*t[0]]},et=function(e,t){var n=e[0]-t[0],i=e[1]-t[1];return ee(n*n+i*i)},tt=function(e,t){for(var n=e.length,r=0,a=0;a<n;a+=1)r+=te(e[a]-t[a],2);return ee(r)},nt=function(e,t){return e.map(function(n,r){return(e[r]+t[r])/2})},it=/*#__PURE__*/Object.freeze({magnitude:Be,normalize:Ue,dot:We,average:Je,cross2:function(e,t){return[e[0]*t[1],e[1]*t[0]]},cross3:$e,distance2:et,distance3:function(t,n){var i=t[0]-n[0],r=t[1]-n[1],a=t[2]-n[2];return ee(i*i+r*r+a*a)},distance:tt,midpoint2:nt}),rt=function(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]},at=function(e,t,n){var r=rt(e,n),a=t.map(function(n,r){return t[r]+e[r]}),l=rt(a,n).map(function(e,t){return e-r[t]});return[r,l]},lt=function(e,t){var n=e[0]*t[0]+e[2]*t[1],i=e[0]*t[2]+e[2]*t[3],r=e[0]*t[4]+e[2]*t[5]+e[4],a=e[1]*t[0]+e[3]*t[1],l=e[1]*t[2]+e[3]*t[3],o=e[1]*t[4]+e[3]*t[5]+e[5];return[n,a,i,l,r,o]},ot=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0],n=e*-t[0]+t[0],i=e*-t[1]+t[1];return[e,0,0,e,n,i]},ct=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0],n=$(e),i=J(e),r=t[0],a=t[1];return[n,i,-i,n,r,a]},gt=function(e,t){var n=t&&t[0]?t[0]:0,i=t&&t[1]?t[1]:0,r=B(e[1],e[0]),l=$(r),o=J(r),g=$(-r),p=J(-r),s=l*g+o*p,a=l*-p+o*g,f=o*g+-l*p,c=o*-p+-l*g;return[s,a,f,c,n+s*-n+-i*f,i+a*-n+-i*c]},dt=function(e){var t=e[0]*e[3]-e[1]*e[2];return t&&!isNaN(t)&&isFinite(e[4])&&isFinite(e[5])?[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]:void 0},pt=/*#__PURE__*/Object.freeze({multiply_vector2_matrix2:rt,multiply_line_matrix2:at,multiply_matrices2:lt,make_matrix2_translation:function(e,t){return[1,0,0,1,e,t]},make_matrix2_scale:ot,make_matrix2_rotation:ct,make_matrix2_reflection:gt,make_matrix2_inverse:dt}),st=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:15;return parseFloat(e.toFixed(t))},ft=function(e){return null!=e&&"function"==typeof e[Symbol.iterator]},ht=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];switch(n.length){case void 0:case 0:return n;case 1:return ft(n[0])?e.apply(void 0,M(n[0])):[n[0]];default:return Array.from(n).map(function(t){return ft(t)?M(e(t)):t}).reduce(function(e,t){return e.concat(t)},[]);}},yt=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i=t;1===i.length&&i[0].length;){var r=i,a=O(r,1);i=a[0]}return i},mt=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=ht(t).filter(function(e){return void 0!==e});if(0!==i.length)return isNaN(i[0].x)||(i=["x","y","z"].map(function(e){return i[0][e]}).filter(function(e){return void 0!==e})),i.filter(function(e){return"number"==typeof e})},ut=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return yt(t).map(function(e){return mt(e)})},_t=[1,0,0,1,0,0],xt=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=mt(t);return 6===r.length?r:6<r.length?[r[0],r[1],r[3],r[4],r[5],r[6]]:6>r.length?_t.map(function(e,t){return r[t]||e}):void 0},vt=1e-6,kt=function(e,t){return Array.from(Array(e.length-1)).map(function(n,r){return t(e[0],e[r+1])}).reduce(function(e,t){return e&&t},!0)},bt=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=ut(n);if(0===r.length)return!1;if(1===r.length&&void 0!==r[0])return e.apply(void 0,M(r[0]));var a=r[0].length,l=Array.from(Array(a));return Array.from(Array(r.length-1)).map(function(e,t){return l.map(function(e,n){return ne(r[t][n]-r[t+1][n])<vt}).reduce(function(e,t){return e&&t},!0)}).reduce(function(e,t){return e&&t},!0)&&Array.from(Array(r.length-1)).map(function(e,t){return r[0].length===r[t+1].length}).reduce(function(e,t){return e&&t},!0)},Pt=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=yt(t);if(1>i.length)return!1;var r=N(i[0]);if("undefined"===r)return!1;switch(i[0].constructor===Array&&(i=i.map(function(e){return yt(e)})),r){case"number":return kt(i,function(e,t){return ne(e-t)<vt});case"boolean":return kt(i,function(e,t){return e===t});case"object":return i[0].constructor===Array?bt(i):(console.warn("comparing array of objects for equivalency by slow stringify and no-epsilon"),kt(i,function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:console.warn("incapable of determining comparison method");}return!1},Lt=/*#__PURE__*/Object.freeze({EPSILON:vt,equivalent_numbers:function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return 0!==n.length&&(1===n.length&&void 0!==n[0]?e.apply(void 0,M(n[0])):kt(n,function(e,t){return ne(e-t)<vt}))},equivalent_vectors:bt,equivalent:Pt}),At=function(e,t,n,i,r){var a=function(e,t){return e[0]*t[1]-t[0]*e[1]},l=a(t,i),o=a([n[0]-e[0],n[1]-e[1]],i),c=a([e[0]-n[0],e[1]-n[1]],t);if(ne(l)<vt)return!1;return r(o/l,c/-l)},wt=function(e,t){return e>=-vt&&e<=1+vt&&t>=-vt&&t<=1+vt},Et=function(e,t,n,i){var r=[t[0]-e[0],t[1]-e[1]],a=[i[0]-n[0],i[1]-n[1]];return At(e,r,n,a,wt)},St=function(e){return ne(e.reduce(function(e,t){return e+t},0))<vt},jt=function(e,t){return 1-ne(We(Ue(e),Ue(t)))<vt},Tt=function(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:vt,r=[n[0]-e[0],n[1]-e[1]],a=r[0]*t[1]-r[1]*t[0];return ne(a)<i},zt=function(e,t){for(var n=!1,r=0,a=t.length-1;r<t.length;a=r++)t[r][1]>e[1]!=t[a][1]>e[1]&&e[0]<(t[a][0]-t[r][0])*(e[1]-t[r][1])/(t[a][1]-t[r][1])+t[r][0]&&(n=!n);return n},Nt=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:vt;return!!(null!=t&&0<t.length)&&t.map(function(t,r,i){var l=i[(r+1)%i.length],o=[l[0]-t[0],l[1]-t[1]],a=[e[0]-t[0],e[1]-t[1]];return o[0]*a[1]-o[1]*a[0]>-n}).map(function(e,t,n){return e===n[0]}).reduce(function(e,t){return e&&t},!0)},Ot=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:vt;return!!(null!=t&&0<t.length)&&t.map(function(t,r,i){var l=i[(r+1)%i.length],o=[l[0]-t[0],l[1]-t[1]],a=[e[0]-t[0],e[1]-t[1]];return o[0]*a[1]-o[1]*a[0]>n}).map(function(e,t,n){return e===n[0]}).reduce(function(e,t){return e&&t},!0)},Mt=function(e,t){for(var n=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}),r=t.map(function(e,t,n){return[e,n[(t+1)%n.length]]}),a=0;a<n.length;a+=1)for(var l=0;l<r.length;l+=1)if(Et(n[a][0],n[a][1],r[l][0],r[l][1]))return!0;return!!zt(t[0],e)||!!zt(e[0],t)},qt=function(e,t,n){for(;n<t;)n+=2*W;for(;e<t;)e+=2*W;return e<n},Dt=/*#__PURE__*/Object.freeze({overlap_function:At,edge_edge_overlap:Et,degenerate:St,parallel:jt,point_on_line:Tt,point_on_edge:function(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:vt,r=[e[0]-t[0],e[1]-t[1]],a=[e[0]-n[0],e[1]-n[1]],l=[t[0]-n[0],t[1]-n[1]],o=ee(r[0]*r[0]+r[1]*r[1]),c=ee(a[0]*a[0]+a[1]*a[1]),g=ee(l[0]*l[0]+l[1]*l[1]);return ne(o-c-g)<i},point_in_poly:zt,point_in_convex_poly:Nt,point_in_convex_poly_exclusive:Ot,convex_polygons_overlap:Mt,convex_polygon_is_enclosed:function(e,t){var n=t.map(function(t){return Nt(t,e)}).reduce(function(e,t){return e||t},!1);return!n&&void 0},convex_polygons_enclose:function(e,t){var n=t.map(function(t){return Nt(t,e)}).reduce(function(e,t){return e||t},!1),i=e.map(function(t){return Nt(t,e)}).reduce(function(e,t){return e&&t},!0);return!n&&i},is_counter_clockwise_between:qt}),Rt=function(){return!0},Ft=function(e,t){return t>=-vt},Xt=function(e,t){return t>=-vt&&t<=1+vt},It=function(e,t){return e>=-vt&&t>=-vt},Vt=function(e,t){return e>=-vt&&t>=-vt&&t<=1+vt},Ct=function(e,t){return e>=-vt&&e<=1+vt&&t>=-vt&&t<=1+vt},Zt=function(e,t){return t>vt},Yt=function(e,t){return t>vt&&t<1-vt},Kt=function(e,t){return e>vt&&t>vt},Qt=function(e,t){return e>vt&&t>vt&&t<1-vt},Ht=function(e,t){return e>vt&&e<1-vt&&t>vt&&t<1-vt},Gt=function(e){return e},Bt=function(e){return e<-vt?0:e},Ut=function(e){return e<-vt?0:e>1+vt?1:e},Wt=function(e,t,n,i,r){function a(e,t){return e[0]*t[1]-t[0]*e[1]}var l=5<arguments.length&&arguments[5]!==void 0?arguments[5]:vt,o=a(t,i);if(!(ne(o)<l)){var c=a([n[0]-e[0],n[1]-e[1]],i),g=a([e[0]-n[0],e[1]-n[1]],t),d=c/o;return r(d,g/-o,l)?[e[0]+t[0]*d,e[1]+t[1]*d]:void 0}},Jt=function(e,t,n,i,r){var a=[i[0]-n[0],i[1]-n[1]];return Wt(e,t,n,a,Xt,r)},$t=function(e,t,n,i,r){var a=[i[0]-n[0],i[1]-n[1]];return Wt(e,t,n,a,Vt,r)},en=function(e,t,n,i,r){var a=[i[0]-n[0],i[1]-n[1]];return Wt(e,t,n,a,Yt,r)},tn=function(e,t,n,i,r){var a=[i[0]-n[0],i[1]-n[1]];return Wt(e,t,n,a,Qt,r)},nn=function(e,t,n,i,r){var a=[t[0]-e[0],t[1]-e[1]],l=[i[0]-n[0],i[1]-n[1]];return Wt(e,a,n,l,Ht,r)},rn=function(e,t,n,i){function r(e){return e<-a?-1:1}var a=4<arguments.length&&arguments[4]!==void 0?arguments[4]:vt,l=n[0]-e[0],o=n[1]-e[1],c=i[0]-e[0],g=i[1]-e[1],d=c-l,p=g-o,s=l*g-c*o,f=s*s,h=t*t,y=ne(d*d+p*p),m=h*y-f;if(!(m<-a)){var u=ee(h*y-f),_=[e[0]+(s*p+r(p)*d*u)/y,e[1]+(-s*d+ne(p)*u)/y];if(m>a){var x=[e[0]+(s*p-r(p)*d*u)/y,e[1]+(-s*d-ne(p)*u)/y];return[_,x]}return[_]}},an=function(){throw"circle_ray has not been written yet"},ln=function(e,t,n,i){function r(e){return 0>e?-1:1}var a=te(t,2),l=n[0]-e[0],o=n[1]-e[1],c=i[0]-e[0],g=i[1]-e[1],d=c-l,p=g-o,s=d*d+p*p,f=l*g-c*o,h=(f*p+r(p)*d*ee(a*s-f*f))/s,y=(f*p-r(p)*d*ee(a*s-f*f))/s,m=(-f*d+ne(p)*ee(a*s-f*f))/s,u=(-f*d-ne(p)*ee(a*s-f*f))/s,_=isNaN(h),x=isNaN(y);return _||x?_&&x?void 0:_?x?void 0:[[y+e[0],u+e[1]]]:[[h+e[0],m+e[1]]]:[[h+e[0],m+e[1]],[y+e[0],u+e[1]]]},on=function(e,t){return ne(e[0]-t[0])<vt&&ne(e[1]-t[1])<vt},cn=function(e,t,n){var r=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Jt(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[r[0],r[0]];case 2:return r;default:for(var a=1;a<r.length;a+=1)if(!on(r[0],r[a]))return[r[0],r[a]];}},gn=function(e,t,n){var r=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return $t(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[t,r[0]];case 2:return r;default:for(var a=1;a<r.length;a+=1)if(!on(r[0],r[a]))return[r[0],r[a]];}},dn=function(e,t,n){var i=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return nn(t,n,e[0],e[1])}).filter(function(e){return null!=e}),r=Ot(t,e),a=Ot(n,e),l=Nt(t,e),o=Nt(n,e);if(0===i.length&&(r||a))return[t,n];if(0===i.length&&l&&o)return[t,n];switch(i.length){case 0:return r?[M(t),M(n)]:void 0;case 1:return l?[M(t),i[0]]:[M(n),i[0]];case 2:return i;default:throw new Error("clipping edge in a convex polygon resulting in 3 or more points");}},pn=/*#__PURE__*/Object.freeze({limit_line:Gt,limit_ray:Bt,limit_edge:Ut,intersection_function:Wt,line_line:function(e,t,n,i,r){return Wt(e,t,n,i,Rt,r)},line_ray:function(e,t,n,i,r){return Wt(e,t,n,i,Ft,r)},line_edge:Jt,ray_ray:function(e,t,n,i,r){return Wt(e,t,n,i,It,r)},ray_edge:$t,edge_edge:function(e,t,n,i,r){var a=[t[0]-e[0],t[1]-e[1]],l=[i[0]-n[0],i[1]-n[1]];return Wt(e,a,n,l,Ct,r)},line_ray_exclusive:function(e,t,n,i,r){return Wt(e,t,n,i,Zt,r)},line_edge_exclusive:en,ray_ray_exclusive:function(e,t,n,i,r){return Wt(e,t,n,i,Kt,r)},ray_edge_exclusive:tn,edge_edge_exclusive:nn,circle_line:rn,circle_ray:an,circle_edge:ln,convex_poly_line:cn,convex_poly_ray:gn,convex_poly_edge:dn,convex_poly_ray_exclusive:function(e,t,n){var r=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return tn(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[t,r[0]];case 2:return r;default:for(var a=1;a<r.length;a+=1)if(!on(r[0],r[a]))return[r[0],r[a]];}}}),sn=function(e,t){for(;0>e;)e+=2*W;for(;0>t;)t+=2*W;var n=t-e;return 0<=n?n:2*W-(e-t)},fn=function(e,t){var n=e[0]*t[0]+e[1]*t[1],i=e[0]*t[1]-e[1]*t[0],r=B(i,n);return 0>r&&(r+=2*W),r},hn=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t.map(function(e){return B(e[1],e[0])}),r=Array.from(Array(i.length)).map(function(e,t){return t}).sort(function(e,t){return i[e]-i[t]});return r.slice(r.indexOf(0),r.length).concat(r.slice(0,r.indexOf(0)))},yn=function(e,t){var n=Ue(e),r=Ue(t),i=n.map(function(e,t){return n[t]+r[t]}),a=Ue(i),l=n.map(function(e,t){return-n[t]+-r[t]});return[a,Ue(l)]},mn=function(e,t,n){var r=fn(t,n)/e;return Array.from(Array(e-1)).map(function(e,n){return t+r*n})},un=function(e,t,n){var i=B(t[1],t[0]),r=B(n[1],n[0]);return mn(e,i,r).map(function(e){return[$(e),J(e)]})},_n=function(e){return .5*e.map(function(e,t,n){var i=n[(t+1)%n.length];return e[0]*i[1]-i[0]*e[1]}).reduce(function(e,t){return e+t},0)},xn=function(e){var t=1/(6*_n(e));return e.map(function(e,t,n){var i=n[(t+1)%n.length],r=e[0]*i[1]-i[0]*e[1];return[(e[0]+i[0])*r,(e[1]+i[1])*r]}).reduce(function(e,t){return[e[0]+t[0],e[1]+t[1]]},[0,0]).map(function(e){return e*t})},vn=function(e){var t=e[0].length,n=Array.from(Array(t)).map(function(){return 1/0}),r=Array.from(Array(t)).map(function(){return-Infinity});e.forEach(function(e){return e.forEach(function(e,t){e<n[t]&&(n[t]=e),e>r[t]&&(r[t]=e)})});var a=r.map(function(e,t){return e-n[t]});return[n,a]},kn=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,l=.5*(2*W/e),o=i/$(l);return Array.from(Array(Math.floor(e))).map(function(r,c){var i=-2*W*c/e+l,a=st(t+o*J(i),14),g=st(n+o*$(i),14);return[a,g]})},bn=function(e,t,n){for(var r,a=t.map(function(t,r){return{o:t,i:r,d:n(e,t)}}),l=1/0,o=0;o<a.length;o+=1)a[o].d<l&&(r=o,l=a[o].d);return r},Pn=function(e,t,n,i){var r=4<arguments.length&&arguments[4]!==void 0?arguments[4]:vt,a=te(t[0],2)+te(t[1],2),l=[0,1].map(function(t,r){return n[r]-e[r]}),o=[0,1].map(function(t,r){return n[r]-e[r]}),c=[0,1].map(function(e,n){return t[n]*l[n]}).reduce(function(e,t){return e+t},0),g=i(c/a,r);return[0,1].map(function(n,r){return e[r]+t[r]*g})},Ln=function(e,t,n){var i=e.map(function(e,r){var i=Tt(t,n,e);return{type:"v",point:i?e:null,at_index:r}}).filter(function(e){return null!=e.point}),r=e.map(function(e,r,i){var a=en(t,n,e,i[(r+1)%i.length]);return{type:"e",point:a,at_index:r}}).filter(function(e){return null!=e.point}),a=i.concat(r).sort(function(e,t){return ne(e.point[0]-t.point[0])<vt?e.point[1]-t.point[1]:e.point[0]-t.point[0]});return console.log(a),e},An=function(e,t,n){var i=e.map(function(e,r){var i=Tt(t,n,e);return{point:i?e:null,at_index:r}}).filter(function(e){return null!=e.point}),r=e.map(function(e,r,i){var a=en(t,n,e,i[(r+1)%i.length]);return{point:a,at_index:r}}).filter(function(e){return null!=e.point});if(2==r.length){var a=r.slice().sort(function(e,t){return e.at_index-t.at_index}),l=e.slice(a[1].at_index+1).concat(e.slice(0,a[0].at_index+1));l.push(a[0].point),l.push(a[1].point);var o=e.slice(a[0].at_index+1,a[1].at_index+1);return o.push(a[1].point),o.push(a[0].point),[l,o]}if(1==r.length&&1==i.length){i[0].type="v",r[0].type="e";var c=i.concat(r).sort(function(e,t){return e.at_index-t.at_index}),g=e.slice(c[1].at_index+1).concat(e.slice(0,c[0].at_index+1));"e"===c[0].type&&g.push(c[0].point),g.push(c[1].point);var d=e.slice(c[0].at_index+1,c[1].at_index+1);return"e"===c[1].type&&d.push(c[1].point),d.push(c[0].point),[g,d]}if(2==i.length){var p=i.slice().sort(function(e,t){return e.at_index-t.at_index}),s=e.slice(p[1].at_index).concat(e.slice(0,p[0].at_index+1)),f=e.slice(p[0].at_index,p[1].at_index+1);return[s,f]}return[e.slice()]},wn=function(e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:vt,n=e.slice().sort(function(e,n){return ne(e[1]-n[1])<t?e[0]-n[0]:e[1]-n[1]}),i=[];i.push(n[0]);var r=0,a=0,l=function(){a+=1;var e=i.length-1,l=n.filter(function(n){return!(ne(n[0]-i[e][0])<t&&ne(n[1]-i[e][1])<t)}).map(function(t){for(var n=B(i[e][1]-t[1],i[e][0]-t[0]);n<r;)n+=2*W;return{node:t,angle:n,distance:void 0}}).sort(function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0});if(0===l.length)return{v:void 0};var o=l[0];return l=l.filter(function(e){return ne(o.angle-e.angle)<t}).map(function(t){var n=ee(te(i[e][0]-t.node[0],2)+te(i[e][1]-t.node[1],2));return t.distance=n,t}).sort(function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0}),0<i.filter(function(e){return e===l[0].node}).length?{v:i}:void(i.push(l[0].node),r=B(i[e][1]-l[0].node[1],i[e][0]-l[0].node[0]))};do{var o=l();if("object"===N(o))return o.v}while(a<1e4)},En=/*#__PURE__*/Object.freeze({clockwise_angle2_radians:function(e,t){for(;0>e;)e+=2*W;for(;0>t;)t+=2*W;var n=e-t;return 0<=n?n:2*W-(t-e)},counter_clockwise_angle2_radians:sn,clockwise_angle2:function(e,t){var n=t[0]*e[0]+t[1]*e[1],i=t[0]*e[1]-t[1]*e[0],r=B(i,n);return 0>r&&(r+=2*W),r},counter_clockwise_angle2:fn,counter_clockwise_vector_order:hn,interior_angles2:function(e,t){var n=fn(e,t);return[n,2*W-n]},interior_angles:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(function(e,t,n){return fn(e,n[(t+1)%n.length])})},bisect_vectors:yn,bisect_lines2:function(e,n,i,r){var a=n[0]*r[1]-r[0]*n[1];if(ne(a)<vt){var l=[nt(e,i),[n[0],n[1]]],o=[l,l],c=n[0]*r[0]+n[1]*r[1];return delete(0<c?o[1]:o[0]),o}var g=(i[0]-e[0])*r[1]-r[0]*(i[1]-e[1]),d=g/a,t=e[0]+n[0]*d,p=e[1]+n[1]*d,s=yn(n,r);return s[1]=[s[1][1],-s[1][0]],s.map(function(e){return[[t,p],e]})},subsect_radians:mn,subsect:un,signed_area:_n,centroid:xn,enclosing_rectangle:vn,make_regular_polygon:kn,nearest_point2:function(e,t){var n=bn(e,t,et);return n===void 0?void 0:t[n]},nearest_point:function(e,t){var n=bn(e,t,tt);return n===void 0?void 0:t[n]},nearest_point_on_line:Pn,split_polygon:Ln,split_convex_polygon:An,convex_hull:wn}),Sn=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return[0,1].map(function(e){return t.filter(function(t,n){return n%2===e}).reduce(function(e,t){return e+t},0)})},jn=function(){return Sn.apply(void 0,arguments).map(function(e){return 0>e?e+2*W:e}).map(function(e){return W-e})},Tn=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(function(e,t,n){return sn(e,n[(t+1)%n.length])}).map(function(e,t,n){return n.slice(t+1,n.length).concat(n.slice(0,t))}).map(function(e){return jn.apply(void 0,M(e))}).map(function(e,n){return t[n]+e[0]}).map(function(e,n){return qt(e,t[n],t[(n+1)%t.length])?e:void 0})},zn=/*#__PURE__*/Object.freeze({alternating_sum:Sn,kawasaki_sector_score:jn,kawasaki_solutions_radians:Tn,kawasaki_solutions:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t.map(function(e){return B(e[1],e[0])});return Tn.apply(void 0,M(i)).map(function(e){return e===void 0?void 0:[st($(e),14),st(J(e),14)]})}}),Nn=function(e){var t,n=[],r=e,a=function(){return r(Ue(t))},l=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=mt(n);return this.length>r.length?We(r,t):We(t,r)},o=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var l=mt(n),o=t.slice();return null==o[2]&&(o[2]=0),null==l[2]&&(l[2]=0),r($e(o,l))},c=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=mt(n),a=t.length<r.length?t.length:r.length,l=Array.from([{a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0}]).map(function(e,n){return te(t[n]-r[n],2)}).reduce(function(e,t){return e+t},0);return ee(l)},g=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var a=xt(n);return r(rt(t,a))},d=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var a=mt(n);return r(t.map(function(e,t){return e+a[t]}))},p=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var a=mt(n);return r(t.map(function(e,t){return e-a[t]}))},s=function(e,n){var i=ct(e,n);return r(rt(t,i))},f=function(){return r(-t[1],t[0])},h=function(){return r(-t[0],-t[1])},y=function(){return r(t[1],-t[0])},m=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var a=C(n),l=gt(a.vector,a.point);return r(rt(t,l))},u=function(e,n){var a=mt(e),l=t.length<a.length?t.length:a.length,o=Array.from([{a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0}]).map(function(e,r){return t[r]*n+a[r]*(1-n)});return r(o)},_=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=mt(n),a=t.length<r.length?t:r,l=t.length<r.length?r:t;return Pt(a,l)},x=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=mt(n),a=t.length<r.length?t:r,l=t.length<r.length?r:t;return jt(a,l)},v=function(e){return r(t.map(function(t){return t*e}))},k=function(){for(var e=arguments.length,n=Array(e),a=0;a<e;a++)n[a]=arguments[a];for(var l=mt(n),o=t.length<l.length?t.slice():l,c=t.length<l.length?l:t.slice(),g=o.length;g<c.length;g+=1)o[g]=0;return r(c.map(function(e,t){return .5*(o[t]+c[t])}))},b=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var a=mt(n);return yn(t,a).map(function(e){return r(e)})};return Object.defineProperty(n,"normalize",{value:a}),Object.defineProperty(n,"dot",{value:l}),Object.defineProperty(n,"cross",{value:o}),Object.defineProperty(n,"distanceTo",{value:c}),Object.defineProperty(n,"transform",{value:g}),Object.defineProperty(n,"add",{value:d}),Object.defineProperty(n,"subtract",{value:p}),Object.defineProperty(n,"rotateZ",{value:s}),Object.defineProperty(n,"rotateZ90",{value:f}),Object.defineProperty(n,"rotateZ180",{value:h}),Object.defineProperty(n,"rotateZ270",{value:y}),Object.defineProperty(n,"reflect",{value:m}),Object.defineProperty(n,"lerp",{value:u}),Object.defineProperty(n,"isEquivalent",{value:_}),Object.defineProperty(n,"isParallel",{value:x}),Object.defineProperty(n,"scale",{value:v}),Object.defineProperty(n,"midpoint",{value:k}),Object.defineProperty(n,"bisect",{value:b}),Object.defineProperty(n,"copy",{value:function(){return r.apply(void 0,M(t))}}),Object.defineProperty(n,"magnitude",{get:function(){return Be(t)}}),Object.defineProperty(n,"bind",{value:function(e){t=e}}),n},On=function e(){var t=Nn(e),n=Object.create(t);t.bind(n);for(var i=arguments.length,r=Array(i),a=0;a<i;a++)r[a]=arguments[a];return mt(r).forEach(function(e){return n.push(e)}),Object.defineProperty(n,"x",{get:function(){return n[0]}}),Object.defineProperty(n,"y",{get:function(){return n[1]}}),Object.defineProperty(n,"z",{get:function(){return n[2]}}),n},Mn=function e(){for(var t=[],n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];xt(i).forEach(function(e){return t.push(e)});return Object.defineProperty(t,"inverse",{value:function(){return e(dt(t).map(function(e){return st(e,13)}))}}),Object.defineProperty(t,"multiply",{value:function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=xt(i);return e(lt(t,a).map(function(e){return st(e,13)}))}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=mt(n);return On(rt(r,t).map(function(e){return st(e,13)}))}}),Object.freeze(t)};Mn.makeIdentity=function(){return Mn(1,0,0,1,0,0)},Mn.makeTranslation=function(e,t){return Mn(1,0,0,1,e,t)},Mn.makeScale=function(){return Mn.apply(void 0,M(ot.apply(void 0,arguments)))},Mn.makeRotation=function(e,t){return Mn(ct(e,t).map(function(e){return st(e,13)}))},Mn.makeReflection=function(e,t){return Mn(gt(e,t).map(function(e){return st(e,13)}))};var qn=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=C(n),a=r.point,l=r.vector,o=Q.bind(this),c=Object.create(o(e));return Object.defineProperty(c,"compare_function",{value:function(){return!0}}),Object.defineProperty(c,"clip_function",{value:Gt}),Object.defineProperty(c,"point",{get:function(){return On(a)}}),Object.defineProperty(c,"vector",{get:function(){return On(l)}}),Object.defineProperty(c,"length",{get:function(){return 1/0}}),Object.defineProperty(c,"transform",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=xt(n),o=at(a,l,r);return e(o[0],o[1])}}),c};qn.fromPoints=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Y(t);return qn({point:i[0],vector:Ue([i[1][0]-i[0][0],i[1][1]-i[0][1]])})},qn.perpendicularBisector=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Y(t),r=Ue([i[1][0]-i[0][0],i[1][1]-i[0][1]]);return qn({point:Je(i[0],i[1]),vector:[r[1],-r[0]]})};var Dn=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=C(n),a=r.point,l=r.vector,o=Q.bind(this),c=Object.create(o(e));return Object.defineProperty(c,"point",{get:function(){return On(a)}}),Object.defineProperty(c,"vector",{get:function(){return On(l)}}),Object.defineProperty(c,"length",{get:function(){return 1/0}}),Object.defineProperty(c,"transform",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=xt(n),o=rt(a,r),c=l.map(function(e,t){return e+a[t]}),g=rt(c,r).map(function(e,t){return e-o[t]});return e(o,g)}}),Object.defineProperty(c,"rotate180",{value:function(){return e(a[0],a[1],-l[0],-l[1])}}),Object.defineProperty(c,"compare_function",{value:function(e,t){return e>=-t}}),Object.defineProperty(c,"clip_function",{value:Bt}),c};Dn.fromPoints=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Y(t);return Dn({point:i[0],vector:Ue([i[1][0]-i[0][0],i[1][1]-i[0][1]])})};var Rn=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=Y(n),a=Q.bind(this),l=Object.create(a(e,[])),o=0<r.length?r.map(function(e){return On(e)}):void 0;if(void 0!==o){o.forEach(function(e,t){l[t]=e});var c=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=xt(n),a=l.map(function(e){return rt(e,r)});return e(a)},g=function(){return On(l[1][0]-l[0][0],l[1][1]-l[0][1])},d=function(){return On(Je(l[0],l[1]))},p=function(){return ee(te(l[1][0]-l[0][0],2)+te(l[1][1]-l[0][1],2))},s=function(e,t){return e>=-t&&e<=1+t};return Object.defineProperty(l,"point",{get:function(){return l[0]}}),Object.defineProperty(l,"vector",{get:function(){return g()}}),Object.defineProperty(l,"midpoint",{value:d}),Object.defineProperty(l,"length",{get:function(){return p()}}),Object.defineProperty(l,"transform",{value:c}),Object.defineProperty(l,"compare_function",{value:s}),Object.defineProperty(l,"clip_function",{value:Ut}),l}},Fn=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[0,0],a=[mt(e),mt(t)];return{contains:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=mt(t).map(function(e,t){return e+r[t]}),l=(i[1]-a[0][1])*-a[0][0]-(i[0]-a[0][0])*-a[0][1],o=i[1]*a[1][0]-i[0]*a[1][1];return 0>l&&0>o},bisect:function(){var e=fn(a[0],a[1]),t=a.map(function(e){return B(e[1],e[0])}),n=t[0]+.5*e;return[$(n),J(n)]},subsect:function(e){return un(e,a[0],a[1]).map(function(e){return[e[0],e[1]]})},get center(){return r},get vectors(){return a},get angle(){return fn(a[0],a[1])}}};Fn.fromVectors=function(e,t){return Fn(e,t)},Fn.fromPoints=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[0,0],i=[e,t].map(function(e){return e.map(function(t,r){return e[r]-n[r]})});return Fn(i[0],i[1],n)};var Xn=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=ut(t).map(function(e){return On(e)});if(void 0!==i){var r=i.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Rn(e[0][0],e[0][1],e[1][0],e[1][1])}),a=H.bind(this),l=Object.create(a());return Object.defineProperty(l,"points",{get:function(){return i}}),Object.defineProperty(l,"sides",{get:function(){return r}}),l}};Xn.regularPolygon=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,r=kn(e,t,n,i);return Xn(r)},Xn.convexHull=function(e){var t=!!(1<arguments.length&&arguments[1]!==void 0)&&arguments[1],n=wn(e,t);return Xn(n)};var In=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=K(n).map(function(e){return On(e)});if(void 0!==r){var a=r.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Rn(e[0][0],e[0][1],e[1][0],e[1][1])}),l=H.bind(this),o=Object.create(l(e)),c=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=C(n);return An(r,a.point,a.vector).map(function(t){return e(t)})},g=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=K(t);return Mt(r,i)},d=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:xn(o.points),i=o.points.map(function(e){return[0,1].map(function(t,r){return e[r]-n[r]})}).map(function(e){return e.map(function(r,a){return n[a]+e[a]*t})});return e(i)},p=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:xn(o.points),i=o.points.map(function(e){var i=[e[0]-n[0],e[1]-n[1]],r=ee(te(i[0],2)+te(i[1],2)),l=B(i[1],i[0]);return[n[0]+$(l+t)*r,n[1]+J(l+t)*r]});return e(i)};return Object.defineProperty(o,"points",{get:function(){return r}}),Object.defineProperty(o,"sides",{get:function(){return a}}),Object.defineProperty(o,"split",{value:c}),Object.defineProperty(o,"overlaps",{value:g}),Object.defineProperty(o,"scale",{value:d}),Object.defineProperty(o,"rotate",{value:p}),o}};In.regularPolygon=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,r=kn(e,t,n,i);return In(r)},In.convexHull=function(e){var t=!!(1<arguments.length&&arguments[1]!==void 0)&&arguments[1],n=wn(e,t);return In(n)};var Vn=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=ut(t);if(void 0!==r){var a=hn.apply(void 0,M(r)),l=function(){return a.map(function(e){return r[e]}).map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Fn.fromVectors(e[0],e[1])})},o=function(){return a.map(function(e){return r[e]}).map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return fn(e[0],e[1])})},c=function(){return Sn.apply(void 0,M(o()))},g=function(){return jn.apply(void 0,M(o()))},d=function(){return Tn.apply(void 0,M(o()))};return{sectors:l,angles:o,kawasaki_score:g,kawasaki_solutions:d,alternatingAngleSum:c,get vectors(){return r},get vectorOrder(){return M(a)}}}};Vn.fromVectors=function(){return Vn.apply(void 0,arguments)},Vn.fromPoints=function(e,t){var n=t.map(function(t){return t.map(function(n,r){return t[r]-e[r]})});return Vn.fromVectors(n)};var Cn=Object.create(null);Object.assign(Cn,it,pt,En,Dt,Lt,zn),Cn.clean_number=st,Cn.is_number=function(e){return null!=e&&!isNaN(e)},Cn.is_vector=function(e){return null!=e&&null!=e[0]&&!isNaN(e[0])},Cn.is_iterable=ft,Cn.flatten_input=ht,Cn.semi_flatten_input=yt,Cn.get_vector=mt,Cn.get_vector_of_vectors=ut,Cn.get_matrix2=xt,Cn.get_edge=V,Cn.get_line=C,Cn.get_ray=Z,Cn.get_two_vec2=Y,Cn.get_array_of_vec=K,Cn.get_array_of_vec2=function(){var e=Array.from(arguments),t=e.filter(function(e){return e.constructor===Array});return 2<=t.length&&!isNaN(t[0][0])?t:1===t.length&&1<=t[0].length?t[0]:e},Cn.intersection=pn,Object.freeze(Cn);var Zn={vector:On,matrix2:Mn,line:qn,ray:Dn,edge:Rn,circle:function(){for(var e,t,n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=Array.from(i),l=a.filter(function(e){return!isNaN(e)});if(3===l.length){e=On(l[0],l[1]);var o=O(l,3);t=o[2]}var c=function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=C(i),l=[a.point[0]+a.vector[0],a.point[1]+a.vector[1]],o=rn(e,t,a.point,l);return o===void 0?void 0:o.map(function(e){return On(e)})},g=function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=Z(i),l=an(e,t,a[0],a[1]);return l===void 0?void 0:l.map(function(e){return On(e)})},d=function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=Y(i),l=ln(e,t,a[0],a[1]);return l===void 0?void 0:l.map(function(e){return On(e)})};return{intersectionLine:c,intersectionRay:g,intersectionEdge:d,get origin(){return e},get radius(){return t},set origin(t){e=On(t)},set radius(e){t=e}}},polygon:Xn,convexPolygon:In,rectangle:function e(){for(var t,n,i,r=arguments.length,a=Array(r),l=0;l<r;l++)a[l]=arguments[l];var o=Array.from(a),c=o.filter(function(e){return!isNaN(e)}),g=o.filter(function(e){return e.constructor===Array});if(4===c.length){t=c.slice(0,2);var d=O(c,4);n=d[2],i=d[3]}1===g.length&&(g=g[0]),2===g.length&&"number"==typeof g[0][0]&&(t=g[0].slice(),n=g[1][0],i=g[1][1]);var p=[[t[0],t[1]],[t[0]+n,t[1]],[t[0]+n,t[1]+i],[t[0],t[1]+i]],s=H.bind(this),f=Object.create(s(e)),h=function(r,a){var l=null==a?[t[0]+n,t[1]+i]:a,o=t[0]+(l[0]-t[0])*(1-r),c=t[1]+(l[1]-t[1])*(1-r);return e(o,c,n*r,i*r)};return Object.defineProperty(f,"origin",{get:function(){return t}}),Object.defineProperty(f,"width",{get:function(){return n}}),Object.defineProperty(f,"height",{get:function(){return i}}),Object.defineProperty(f,"area",{get:function(){return n*i}}),Object.defineProperty(f,"scale",{value:h}),Object.defineProperty(f,"rotate",{value:function(){var e;return(e=In(p)).rotate.apply(e,arguments)}}),Object.defineProperty(f,"transform",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return In(p).transform(t)}}),f},junction:Vn,sector:Fn,core:Cn};// import convert from "../include/fold/convert";
// import filter from "../include/fold/filter";
// import {
//   remove_vertices,
//   remove_edges,
//   remove_faces,
// } from "./remove";
/**
   * provide arrays as arguments, this will filter out anything undefined
   * @returns {number} length of the longest array
   */const Yn=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return U(...t.filter(e=>e!==void 0).map(e=>e.length))},Kn={vertices:function vertices_count(e){let{vertices_coords:t,vertices_faces:n,vertices_vertices:i}=e;return Yn([],t,n,i)},edges:function edges_count(e){let{edges_vertices:t,edges_faces:n}=e;return Yn([],t,n)},faces:function faces_count(e){let{faces_vertices:t,faces_edges:n}=e;return Yn([],t,n)}},Qn=function(e,t,n){const i=Kn[t](e),r=Array(i).fill(!1);n.forEach(e=>{r[e]=!0});let a=0;// index_map length is the original length of the geometry (vertices_faces)
const l=r.map(e=>e?--a:a);if(0===n.length)return l;// these comments are written as if "vertices" was provided as the key
const o="".concat(t,"_"),c="_".concat(t),g=Object.keys(e),d=g.map(e=>e.substring(0,o.length)===o?e:void 0).filter(e=>void 0!==e),p=g.map(e=>e.substring(e.length-c.length,e.length)===c?e:void 0).filter(e=>void 0!==e);return p.forEach(t=>e[t].forEach((n,r)=>e[t][r].forEach((n,i)=>{e[t][r][i]+=l[n]}))),d.forEach(t=>{e[t]=e[t].filter((e,t)=>!r[t])}),l},Hn=function(e,t){return Qn(e,"vertices",t);// todo: do the same with frames in file_frames where inherit=true
},Gn=function(e){let t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:Zn.core.EPSILON;// console.log(graph.vertices_coords.length);
// filter.subdivideCrossingEdges_vertices(graph);
const n=Bn(e,t);// convert.edges_vertices_to_vertices_vertices_sorted(graph);
// convert.vertices_vertices_to_faces_vertices(graph);
// convert.faces_vertices_to_faces_edges(graph);
return n},Bn=function(e){let t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Zn.core.EPSILON;const n=function(e,t){return e[0]-t[0]},r=function(e,t){return e[1]-t[1]},a=function(e,n){for(let r=0;r<e.length;r+=1)if(ne(e[r]-n[r])>t)return!1;return!0},l=e.edges_vertices.length,o=e.edges_vertices.map(t=>[e.vertices_coords[t[0]],e.vertices_coords[t[1]]]),c=o.map(t=>[t[1][0]-t[0][0],t[1][1]-t[0][1]]),g=c.map(t=>ee(t[0]*t[0]+t[1]*t[1])),d=c.map((t,e)=>[t[0]/g[e],t[1]/g[e]]),p=d.map(t=>.707<ne(t[0])),s=Array.from(Array(l-1)).map(()=>[]);for(let t=0;t<o.length-1;t+=1)for(let e=t+1;e<o.length;e+=1)s[t][e]=Zn.core.intersection.edge_edge_exclusive(o[t][0],o[t][1],o[e][0],o[e][1]);const f=Array.from(Array(l)).map(()=>[]);for(let t=0;t<o.length-1;t+=1)for(let e=t+1;e<o.length;e+=1)null!=s[t][e]&&(// warning - these are shallow pointers
f[t].push(s[t][e]),f[e].push(s[t][e]));// let edges_intersections2 = Array.from(Array(edge_count)).map(_ => []);
// for (let i = 0; i < edges.length-1; i++) {
//  for (let j = i+1; j < edges.length; j++) {
//    if (crossings[i][j] != null) {
//      // warning - these are shallow pointers
//      edges_intersections2[i].push({edge:j, intersection:crossings[i][j]});
//      edges_intersections2[j].push({edge:i, intersection:crossings[i][j]});
//    }
//  }
// }
o.forEach((t,e)=>t.sort(p[e]?n:r)),f.forEach((t,e)=>t.sort(p[e]?n:r));// edges_intersections2.forEach((e,i) =>
//  e.sort(edges_horizontal[i] ? horizSort2 : vertSort2)
// )
let h=f.map((t,e)=>[o[e][0],...t,o[e][1]]).map(e=>Array.from(Array(e.length-1)).map((t,n)=>[e[n],e[n+1]]));// remove degenerate edges
h=h.map(e=>e.filter(n=>!1===n.map((e,r)=>ne(n[0][r]-n[1][r])<t).reduce((e,t)=>e&&t,!0)));// let edge_map = new_edges.map(edge => edge.map(_ => counter++));
const y=h.map((e,t)=>e.map(()=>t)).reduce((e,t)=>e.concat(t),[]);console.log("edge_map",y);const m=h.map(e=>e.reduce((e,t)=>e.concat(t),[])).reduce((e,t)=>e.concat(t),[]);let u=0;const _=h.map(e=>e.map(()=>[u++,u++])).reduce((e,t)=>e.concat(t),[]),x=Array.from(Array(m.length)).map(()=>[]);for(let t=0;t<m.length-1;t+=1)for(let e=t+1;e<m.length;e+=1)x[t][e]=a(m[t],m[e]);// console.log(vertices_equivalent);
const k=m.map(()=>void 0);x.forEach((e,t)=>e.forEach((e,n)=>{e&&(k[n]=void 0===k[t]?t:k[t])}));const b=k.map(e=>void 0!==e);k.forEach((e,t)=>{void 0===e&&(k[t]=t)}),_.forEach((e,t)=>e.forEach((e,n)=>{_[t][n]=k[e]}));const P={vertices_coords:m,edges_vertices:_},L=b.map((e,t)=>e?t:void 0).filter(e=>void 0!==e);// console.log("edges_vertices", edges_vertices);
// console.log("vertices_remove", vertices_remove);
// console.log(flat);
// convert.edges_vertices_to_vertices_vertices_sorted(flat);
// convert.vertices_vertices_to_faces_vertices(flat);
// convert.faces_vertices_to_faces_edges(flat);
return Hn(P,L),P},Un={V:180,v:180,M:-180,m:-180},Wn=function(e){return Un[e]||0},Jn=function(){return{file_spec:1.1,file_creator:"Rabbit Ear",file_classes:["singleModel"],frame_title:"",frame_classes:["creasePattern"],frame_attributes:["2D"],vertices_coords:[],vertices_vertices:[],vertices_faces:[],edges_vertices:[],edges_faces:[],edges_assignment:[],edges_foldAngle:[],edges_length:[],faces_vertices:[],faces_edges:[]}},$n=function(e){if(null!=e[4]){const t=e[4].stroke;if(null!=t)return Ge(t)}return"U"},ei=function(e){const t=Jn(),n=t.vertices_coords.length,i=Ye(e);// console.log("svg_to_fold");
// todo: import semgents into a planar graph, handle edge crossings
// Graph.makeComplete(graph);
return t.vertices_coords=i.map(e=>[[e[0],e[1]],[e[2],e[3]]]).reduce((e,t)=>e.concat(t),[]),t.edges_vertices=i.map((e,t)=>[n+2*t,n+2*t+1]),t.edges_assignment=i.map(e=>$n(e)),t.edges_foldAngle=t.edges_assignment.map(e=>Wn(e)),console.log(Gn(t)),t};/* Get the number of vertices, edges, faces in the graph sourcing only their
   * primary key arrays. in the case of abstract graphs, use "implied" functions
   * @returns {number} number of geometry elements
   */return{SVGtoFOLD:function SVGtoFOLD(e,t){if("string"==typeof e){const n=new le.DOMParser().parseFromString(e,"text/xml").documentElement;return ei(n,t)}// if (input instanceof Document) {
return ei(e,t);// let fold = svg_to_fold(result, options);
},interpret:{segmentize:()=>{},fragment:()=>{}}}});
